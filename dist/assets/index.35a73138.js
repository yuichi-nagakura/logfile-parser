import{s as w}from"./vendor.c3d1e833.js";const B=function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const o of e)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&t(l)}).observe(document,{childList:!0,subtree:!0});function n(e){const o={};return e.integrity&&(o.integrity=e.integrity),e.referrerpolicy&&(o.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?o.credentials="include":e.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function t(e){if(e.ep)return;e.ep=!0;const o=n(e);fetch(e.href,o)}};B();var z;(z=document.querySelector("form"))==null||z.addEventListener("submit",async i=>{i.preventDefault();const r=document.querySelector("input"),n=r==null?void 0:r.files;if(!n)return;const t=await A(n[0]),e=O(t),o=$(e);N("log.csv",o)});const $=i=>{const r=i.map(t=>`${t.handle},${t.layer},${t.bottom_x},${t.bottom_y},${t.bottom_z},${t.top_x},${t.top_y},${t.top_z}`);return["Handle,Layer,Boundary_Bottom_X,Boundary_Bottom_Y,Boundary_Bottom_Z,Boundary_Top_X,Boundary_Top_Y,Boundary_Top_Z",...r].join(`
`)};function N(i,r){const n=new Blob([r],{type:"text/plain"}),t=URL.createObjectURL(n),e=document.createElement("a");document.body.appendChild(e),e.download=i,e.href=t,e.click(),e.remove(),URL.revokeObjectURL(t)}const O=i=>{var y,b,h,_,x,g,v,L;const r=[],n=[],t=[],e=[],o=[],l=i.split(`\r
`);for(const s of l){let a=/ハンドル\s+=\s+(\w+)/g;const u=(y=a.exec(s))==null?void 0:y.at(-1);u&&r.push(u),a=/3DSOLID   画層:\s+\"(.+)\"$/g;const d=(b=a.exec(s))==null?void 0:b.at(-1);d&&n.push(d),a=/境界下部 X\s+=\s+(.+)、Y\s+=\s+(.+)、Z\s+=\s+(.+)$/g;let c=a.exec(s);if(c){const m=(h=c.at(-3))==null?void 0:h.trim(),f=(_=c.at(-2))==null?void 0:_.trim(),p=(x=c.at(-1))==null?void 0:x.trim();t.push({x:Number(m),y:Number(f),z:Number(p)})}if(a=/境界上部 X = (.+)、Y = (.+)、Z = (.+)$/g,c=a.exec(s),c){const m=(g=c.at(-3))==null?void 0:g.trim(),f=(v=c.at(-2))==null?void 0:v.trim(),p=(L=c.at(-1))==null?void 0:L.trim();e.push({x:Number(m),y:Number(f),z:Number(p)})}}for(let s=0;s<r.length;s++){const a=r[s],u=e[s],d=t[s],c=n[s],m={handle:a,layer:c,top_x:u.x,top_y:u.y,top_z:u.z,bottom_x:d.x,bottom_y:d.y,bottom_z:d.z};o.push(m)}return o},A=i=>new Promise((r,n)=>{const t=new FileReader;t.onload=()=>{const e=t.result,o=w.convert(new Uint8Array(e),{from:"SJIS",to:"UNICODE"}),l=w.codeToString(o);r(l)},t.onerror=()=>{n(new Error("error occurred"))},t.readAsArrayBuffer(i)});
